<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Listagem de Produtos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap @5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 30px; background-color: #f8f9fa; }
    .produto-card img { width: 100%; max-height: 200px; object-fit: cover; }
  </style>
</head>
<body>

<div class="container">

  <h1 class="mb-4">Produtos</h1>

  <!-- Formulário -->
  <form action="/produtos" method="POST" enctype="multipart/form-data" class="mb-4">
    <div class="row g-3">
      <div class="col-md-6">
        <input type="text" name="nome" placeholder="Nome do produto" class="form-control" required>
      </div>
      <div class="col-md-4">
        <input type="number" name="preco" placeholder="Preço (ex: 15000)" class="form-control" required>
      </div>
      <div class="col-md-4">
        <input type="file" name="imagem" class="form-control">
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-success w-100">Cadastrar</button>
      </div>
    </div>
  </form>

  <!-- Filtro -->
  <form action="/buscar" method="GET" class="mb-4">
    <div class="input-group">
      <input type="text" name="q" placeholder="Buscar por nome..." class="form-control" value="{{busca}}">
      <button class="btn btn-outline-secondary" type="submit">Buscar</button>
    </div>
  </form>

  <!-- Produtos -->
  {{#if produtos}}
    <div class="row g-4">
      {{#each produtos}}
        <div class="col-md-4">
          <div class="card shadow-sm produto-card h-100">
            {{#if this.imagem}}
              <img src="{{this.imagem}}" alt="{{this.nome}}">
            {{else}}
              <div class="bg-light d-flex justify-content-center align-items-center" style="height: 200px;">
                Sem imagem
              </div>
            {{/if}}
            <div class="card-body">
              <h5 class="card-title">{{this.nome}}</h5>
              <p class="card-text text-primary fs-5">R$ {{formatarPreco this.preco}}</p>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  {{else}}
    <p class="alert alert-info">Nenhum produto encontrado.</p>
  {{/if}}

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap @5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
<<style>
  body {
    padding: 30px;
    background-color: #f8f9fa;
  }

  .produto-card {
    height: auto;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .produto-card img {
    width: 100%;
    max-height: 120px; /* Altura máxima menor */
    object-fit: cover;
    border-bottom: 1px solid #ddd;
  }

  .card-body {
    padding: 10px;
  }

  .card-title {
    font-size: 0.95rem;
    margin-bottom: 5px;
  }

  .card-text {
    font-size: 0.85rem;
    color: #4a4a4a;
  }

  .col-md-4 {
    max-width: 300px; /* Limita o tamanho máximo do card */
  }
</style>
</html>